!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.CanvasEditTools=t():e.CanvasEditTools=t()}(this,(()=>(()=>{"use strict";var e={d:(t,n)=>{for(var o in n)e.o(n,o)&&!e.o(t,o)&&Object.defineProperty(t,o,{enumerable:!0,get:n[o]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r:e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}},t={};function n(e){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n(e)}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,l(o.key),o)}}function r(e,t,n){return t&&i(e.prototype,t),n&&i(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function a(e,t,n){return(t=l(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function l(e){var t=function(e,t){if("object"!==n(e)||null===e)return e;var o=e[Symbol.toPrimitive];if(void 0!==o){var i=o.call(e,"string");if("object"!==n(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===n(t)?t:String(t)}function s(){var e,t=this,n=document.getElementById("myCanvas");n&&(e=n.getContext("2d"));var i,l,s,c,d,u,m=document.getElementById("custom-dialog"),y=document.getElementById("custom-input"),h=document.getElementById("custom-accept"),p=document.getElementById("custom-cancel"),f=!1,v=0,g=0,b=!1,E=0,x=null,w=[],k=!1,L=document.querySelector(".menu"),I=function(){w=[],M()},B=function(){console.log("undo"),console.log(s),s=w.pop(),console.log(s),M()},C=function(){w.push(s),M()},M=function(){e.clearRect(0,0,n.width,n.height),w.forEach((function(t){if("image"===t.type){if(t.carousal)e.drawImage(t.element,t.x+t.width/2,t.y+t.height/8,t.width,.75*t.height),e.drawImage(t.element,t.x-t.width/2,t.y+t.height/8,t.width,.75*t.height),e.drawImage(t.element,t.x,t.y,t.width,t.height);else if(e.drawImage(t.element,t.x,t.y,t.width,t.height),b){var o=t.x+t.width-8,i=t.y+t.height-8;e.fillStyle="#000",e.fillRect(o,i,8,8),e.fillStyle="#fff"}}else if(t.x+t.width>0&&t.y+t.height>0&&t.x<n.width&&t.y<n.height)if(t.banner)e.font="bold 36px Arial",e.fillStyle="white",e.fillText(t.text,t.x,t.y+30);else{e.font="bold 12px Arial",e.fillStyle="white";for(var r=t.maxWidth,a=t.text.split(" "),l="",s=[],c=0;c<a.length;c++){var d=l+a[c]+" ";e.measureText(d).width>r?(s.push(l),l=a[c]+" "):l=d}s.push(l),s.length,e.fillStyle="white";for(var u=0;u<s.length;u++)e.fillText(s[u],t.x+5,t.y-3+14*(u+1))}}))},S=function(e){if(!k){if(2===e.button){for(var t=e.clientX-n.offsetLeft,o=e.clientY-n.offsetTop,i=0;i<w.length;i++){var r=w[i];if(t>r.x&&t<r.x+r.width&&o>r.y&&o<r.y+r.height){l=r;break}}return}f=!0;for(var a=e.clientX-n.offsetLeft,s=e.clientY-n.offsetTop,c=0;c<w.length;c++){var d=w[c];if(a>d.x&&a<d.x+d.width&&s>d.y&&s<d.y+d.height){a>d.x+d.width-8&&s>d.y+d.height-8?(b=!0,l=d,startX=a,startY=s):(v=a-d.x,g=s-d.y,l=d);break}}}k=!1};function T(){x&&(c=Object.assign({},x),w.push(c),M()),L.style.display="none"}function j(e){if(i)if("text"===i.type)x={x:i.x+50,y:i.y+50,width:i.width,height:i.height,text:i.text,banner:i.banner,type:i.type,maxWidth:i.maxWidth,color:i.color};else if("image"===i.type){var t;a(t={type:"image",element:i.element,x:i.x+20,y:i.y+20,width:i.width},"type",i.type),a(t,"height",i.height),a(t,"url",i.url),x=t}c=Object.assign({},x),i=null,L.style.display="none"}function P(){L.style.display="none",y.select(),i&&"text"===i.type&&D((function(e){e&&(i.text=e,M(),L.style.display="none")}),i.text)}var H=function(e){if(f){if(b){var t=0,o=0;e.clientX<startX||e.clientY<startY?(t-=2,o-=2):(t+=2,o+=2),l.width+=t,l.height+=o,startX=e.clientX,startY=e.clientY}else l.x=e.clientX-n.offsetLeft-v,l.y=e.clientY-n.offsetTop-g;M()}},O=function(e){f=!1,b=!1,i=l,l=null,M()},A=function(){var e=w.map((function(e){return{x:e.x,y:e.y,text:e.text,imageW:e.width,imageH:e.height,url:e.url,carousal:e.carousal}}));localStorage.setItem("itemPositions",JSON.stringify(e));var t=document.querySelector('meta[name="_csrf_header"]').content,n=document.querySelector('meta[name="_csrf"]').content,o=prompt("Please enter a title:");fetch("/api/addPage",{method:"POST",headers:a({"Content-Type":"application/json"},t,n),body:JSON.stringify({itemPositions:e,title:o})}).then((function(e){if(!e.ok)throw new Error("Response not OK");return e.json()})).then((function(e){window.location.href="/page/template?id=".concat(e)})).catch((function(e){console.error("There was a problem adding the page:",e)}))},R=function(){D((function(t){if(""!==t){var n={x:Math.floor(300*Math.random()+100),y:Math.floor(300*Math.random()+100),width:e.measureText(t).width+20,height:50,text:t,type:"text",banner:!1,maxWidth:200,color:"white"};w.push(n)}M()}),"")},X=function(){if(null!=d){document.getElementById("editor").classList.remove("success"),document.querySelector(".image-grid").innerHTML="",document.getElementById("searchInput").value="";var e=d,t=new Image;t.onload=function(){var n=t.width,o=t.height,i=1;(n>350||o>500)&&(n*=i=n/350>o/500?350/n:500/o,o*=i);var r=document.createElement("canvas");r.width=n,r.height=o,r.getContext("2d").drawImage(t,0,0,n,o);var a=new Image;a.onload=function(){w.push({type:"image",element:a,x:0,y:0,carousal:!0,width:a.width,height:a.height,url:e.urls.thumb}),M(),URL.revokeObjectURL(a.src)},a.src=e.urls.thumb},t.src=e.urls.thumb,d=null}else alert("Select a Image")},Y=function(){var t=prompt("Please enter some text:");if(null!==t&&""!==t){var n={itemId:E++,x:Math.floor(300*Math.random()+100),y:Math.floor(300*Math.random()+100),width:e.measureText(t).width+20,height:50,text:t,banner:!0,color:"rgb(".concat(Math.floor(256*Math.random()),", ").concat(Math.floor(256*Math.random()),", ").concat(Math.floor(256*Math.random()),")")};w.push(n),M()}},q=function(){if(null!=d){console.log(u),document.getElementById("editor").style.height=u,document.getElementById("editor").classList.remove("success"),document.querySelector(".image-grid").innerHTML="",document.getElementById("searchInput").value="";var e=d,t=new Image;t.onload=function(){var n=t.width,o=t.height,i=1;(n>350||o>500)&&(n*=i=n/350>o/500?350/n:500/o,o*=i);var r=document.createElement("canvas");r.width=n,r.height=o,r.getContext("2d").drawImage(t,0,0,n,o);var a=new Image;a.onload=function(){w.push({type:"image",element:a,x:0,y:0,width:a.width,height:a.height,url:e.urls.thumb}),M(),URL.revokeObjectURL(a.src)},a.src=e.urls.thumb},t.src=e.urls.thumb,d=null}else alert("Select a Image")},V=function(){var e=document.getElementById("searchInput").value;fetch("".concat("https://api.unsplash.com/","search/photos?page=1&query=").concat(e,"&client_id=").concat("NaHFk6fEWYCWjF10KF4L9EiplttQNKmTUu6rcLJ9uLc")).then((function(e){return e.json()})).then((function(e){return t.images=e.results,e.results})).then(U).catch((function(e){console.error("Error fetching images:",e)}))};function K(e){var t=document.getElementById("html");"active"===e?(t.style.backgroundColor="rgb(68, 68, 68)",t.style.color="white"):(t.style.backgroundColor="white",t.style.color="black")}function D(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";function n(){var t=y.value.trim();e(t),m.style.display="none",h.removeEventListener("click",n),p.removeEventListener("click",o)}function o(){m.style.display="none",h.removeEventListener("click",n),p.removeEventListener("click",o)}m.style.display="block",y.value=t,y.focus(),y.addEventListener("keydown",(function t(n){if("Enter"===n.key){var o=y.value.trim();e(o),m.style.display="none",y.removeEventListener("keydown",t)}})),h.addEventListener("click",n),p.addEventListener("click",o)}function W(){var e=document.getElementById("editor");K("active"),e.style.display="none"}function z(){var e=document.getElementById("editor");"none"===e.style.display?(e.style.display="",K("unActive")):(K("active"),W())}function U(e){u=document.getElementById("editor").style.height,document.getElementById("editor").style.height="1000px";var t=document.querySelector(".image-grid");t.innerHTML="";for(var n=function(n){var o=document.createElement("img");o.src=e[n].urls.thumb,o.id=(n+1).toString(),o.addEventListener("click",(function(){for(var i=t.querySelectorAll("img"),r=0;r<i.length;r++)i[r]!==o&&(i[r].style.border=null);o.style.border="2px solid black",d=e[n]})),t.appendChild(o)},o=0;o<e.length;o++)n(o)}var _=function(){function e(t){o(this,e),this.container=document.getElementById(t),this.container.innerHTML='\n                <div>\n                <div\n            class = "menu" >\n                <ul\n            class = "menu-list" >\n                <li\n            class = "menu-item" >\n                <button\n            class = "menu-button"\n            id = "undo-btn">\n                <svg > </svg>\n    \n            <span>Undo </span>\n            <span>CTRL+Z</span>\n        </button>\n        </li>\n        </ul>\n            <ul class="menu-list">\n                <li class="menu-item">\n                    <button class="menu-button" id="copy-btn">\n                        <svg class="css-i6dzq1" fill="none" height="24" stroke="currentColor" stroke-linecap="round"\n                             stroke-linejoin="round"\n                             stroke-width="2" viewBox="0 0 24 24" width="24">\n                            <rect height="13" rx="2" ry="2" width="13" x="9" y="9"></rect>\n                            <path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path>\n                        </svg>\n    \n                        <span>Copy </span>\n                        <span>CTRL+C</span>\n                    </button>\n                </li>\n                <li class="menu-item">\n                    <button class="menu-button" id="paste-btn">\n                        <svg class="css-i6dzq1" fill="none" height="24" stroke="currentColor" stroke-linecap="round"\n                             stroke-linejoin="round"\n                             stroke-width="2" viewBox="0 0 24 24" width="24">\n                            <path d="M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2"></path>\n                            <rect height="4" rx="1" ry="1" width="8" x="8" y="2"></rect>\n                        </svg>\n    \n                        <span>Paste </span>\n                        <span>CTRL+V</span>\n                    </button>\n                </li>\n                <li class="menu-item">\n                    <button class="menu-button" id="edit-btn">\n                        <svg fill="none" height="24" id="IconChangeColor" stroke-width="1.5" viewBox="0 0 24 24"\n                             width="24" xmlns="http://www.w3.org/2000/svg">\n                            <path\n                                d="M20 12V5.74853C20 5.5894 19.9368 5.43679 19.8243 5.32426L16.6757 2.17574C16.5632 2.06321 16.4106 2 16.2515 2H4.6C4.26863 2 4 2.26863 4 2.6V21.4C4 21.7314 4.26863 22 4.6 22H11"\n                                id="mainIconPathAttribute" stroke="currentColor" stroke-linecap="round"\n                                stroke-linejoin="round"></path>\n                            <path d="M8 10H16M8 6H12M8 14H11" id="mainIconPathAttribute" stroke="currentColor"\n                                  stroke-linecap="round" stroke-linejoin="round"></path>\n                            <path\n                                d="M16 5.4V2.35355C16 2.15829 16.1583 2 16.3536 2C16.4473 2 16.5372 2.03725 16.6036 2.10355L19.8964 5.39645C19.9628 5.46275 20 5.55268 20 5.64645C20 5.84171 19.8417 6 19.6464 6H16.6C16.2686 6 16 5.73137 16 5.4Z"\n                                fill="currentColor" id="mainIconPathAttribute" stroke="currentColor"\n                                stroke-linecap="round"\n                                stroke-linejoin="round"></path>\n                            <path\n                                d="M17.9541 16.9394L18.9541 15.9394C19.392 15.5015 20.102 15.5015 20.5399 15.9394V15.9394C20.9778 16.3773 20.9778 17.0873 20.5399 17.5252L19.5399 18.5252M17.9541 16.9394L14.963 19.9305C14.8131 20.0804 14.7147 20.2741 14.6821 20.4835L14.4394 22.0399L15.9957 21.7973C16.2052 21.7646 16.3988 21.6662 16.5487 21.5163L19.5399 18.5252M17.9541 16.9394L19.5399 18.5252"\n                                id="mainIconPathAttribute" stroke="currentColor" stroke-linecap="round"\n                                stroke-linejoin="round"></path>\n                        </svg>\n    \n                        <span>Edit </span>\n                        <span>CTRL+E</span>\n                    </button>\n                </li>\n                <li class="menu-item">\n                    <button class="menu-button" id="delete-btn">\n                        <svg class="css-i6dzq1" fill="none" height="24" stroke="currentColor" stroke-linecap="round"\n                             stroke-linejoin="round"\n                             stroke-width="2" viewBox="0 0 24 24" width="24">\n                            <polyline points="3 6 5 6 21 6"></polyline>\n                            <path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"></path>\n                            <line x1="10" x2="10" y1="11" y2="17"></line>\n                            <line x1="14" x2="14" y1="11" y2="17"></line>\n                        </svg>\n    \n                        <span>Delete </span>\n                        <span>CTRL+X</span>\n                    </button>\n                </li>\n            </ul>\n            <ul class="menu-list">\n                <li class="menu-item">\n                    <button class="menu-button">\n                        <svg></svg>\n    \n                        <span>Select All</span>\n                        <span>CTRL+A</span>\n                    </button>\n                </li>\n    \n            </ul>\n    \n        </div>\n        </div>\n     '}return r(e,[{key:"getContainer",value:function(){return this.container}}]),e}(),N=function(){function e(t){o(this,e),this.container=document.getElementById(t),this.container.innerHTML='\n          <div class="editor-header">\n            <button class="button" id="closeButton">X</button>\n          </div>\n          <div class="editor-content">\n            <div class="editor-section top">\n              <button class="button" id="addBanner">Add Banner</button>\n            </div>\n            <div class="editor-section left">\n              <button class="button" id="addBtn">Add Text</button>\n            </div>\n            <div class="editor-section left">\n              <button class="button" id="addCarousal">Create carousal</button>\n            </div>\n            <div class="editor-section right">\n              <div>\n                <form action="#" class="flex mb-8 m-auto max-w-md">\n                  <input class="border border-gray-300 text-sm p-2 flex-grow mr-2 rounded shadow" id="searchInput" placeholder="Example : coffee, people, ..." type="text" />\n                  <button class="inline-flex items-center" id="searchButton" type="submit">Search</button>\n                </form>\n                <button class="button" id="AddImage">Add image</button>\n                <div class="image-grid"></div>\n              </div>\n            </div>\n            <div class="editor-section bottom">\n            </div>\n          </div>\n        '}return r(e,[{key:"getContainer",value:function(){return this.container}}]),e}();!function(){if(document.getElementById("editor")){var e=new N("editor");document.body.appendChild(e.getContainer())}if(document.getElementById("contextMenu")){var t=new _("contextMenu");document.body.appendChild(t.getContainer())}n&&(n.addEventListener("mousedown",S),n.addEventListener("mousemove",H),n.addEventListener("mouseup",O));var o=document.getElementById("saveBtn");o&&o.addEventListener("click",A);var r=document.getElementById("undoBtn");r&&r.addEventListener("click",B),document.getElementById("forwardBtn").addEventListener("click",C);var a=document.getElementById("resetButton");a&&a.addEventListener("click",I);var d=document.getElementById("searchButton");d&&d.addEventListener("click",V);var u=document.getElementById("AddImage");u&&u.addEventListener("click",q);var m=document.getElementById("addBanner");m&&m.addEventListener("click",Y);var y=document.getElementById("html");y&&y.addEventListener("click",z);var h=document.getElementById("closeButton");h&&h.addEventListener("click",W);var p,f,v=document.getElementById("editor");v&&(v.addEventListener("dragstart",(function(e){p=e.clientX-v.offsetLeft,f=e.clientY-v.offsetTop,v.style.opacity="0.8"})),v.addEventListener("drag",(function(e){v.style.left=e.clientX-p+"px",v.style.top=e.clientY-f+"px"})),v.addEventListener("dragend",(function(e){v.style.opacity="1"})));var g=document.getElementById("addBtn");g&&g.addEventListener("click",R);var b=document.getElementById("addCarousal");b&&b.addEventListener("click",X),(L=document.getElementById("contextMenu"))&&(L.style.display="none",document.addEventListener("contextmenu",(function(e){k=!0,e.preventDefault(),L.style.display="block",L.style.position="fixed",L.style.top=e.clientY+"px",L.style.left=e.clientX+"px",c?(U.style.pointerEvents="auto",U.style.opacity="1"):(U.style.pointerEvents="none",U.style.opacity="0.5"),0!==w.length&&s?(x.style.pointerEvents="auto",x.style.opacity="1"):(x.style.pointerEvents="none",x.style.opacity="0.5"),l?(K.style.pointerEvents="auto",K.style.opacity="1",E.style.pointerEvents="auto",E.style.opacity="1",D.style.pointerEvents="auto",D.style.opacity="1"):(K.style.pointerEvents="none",K.style.opacity="0.5",E.style.pointerEvents="none",E.style.opacity="0.5",D.style.pointerEvents="none",D.style.opacity="0.5")})),document.addEventListener("click",(function(e){L.contains(e.target)||(L.style.display="none")})),document.addEventListener("keydown",(function(e){"Escape"===e.key&&(L.style.display="none")})));var E=document.getElementById("delete-btn");E&&E.addEventListener("click",(function(){if(i){var e=w.findIndex((function(e){return e.x===i.x}));-1!==e&&(w.splice(e,1),i=null),L.style.display="none",M()}}));var x=document.getElementById("undo-btn");x&&x.addEventListener("click",(function(){B(),L.style.display="none"}));var K=document.getElementById("edit-btn");K&&K.addEventListener("click",P);var D=document.getElementById("copy-btn");D&&D.addEventListener("click",j),document.getElementById("contextMenu")&&document.addEventListener("keydown",(function(e){e.metaKey&&"c"===e.key&&(e.preventDefault(),j()),e.metaKey&&"v"===e.key&&(e.preventDefault(),T()),e.metaKey&&"x"===e.key&&(e.preventDefault(),deleteCurrentItem()),e.metaKey&&"z"===e.key&&(e.preventDefault(),B()),e.metaKey&&"e"===e.key&&(e.preventDefault(),P())}));var U=document.getElementById("paste-btn");U&&U.addEventListener("click",T)}()}e.r(t),e.d(t,{default:()=>c,initialize:()=>s});const c={initialize:s};return t})()));